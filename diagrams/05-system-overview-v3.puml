@startuml system-overview-v3
skinparam backgroundColor #FFFFFF
skinparam defaultFontSize 10
skinparam monochrome true
skinparam shadowing false
skinparam packageStyle rectangle
skinparam rectangleBorderThickness 1

title Kiến Trúc Tổng Quan - KiteClass Platform

actor "Người dùng" as USER

rectangle "Đăng ký" as REG
rectangle "Sử dụng" as USE

USER -down-> REG
USER -down-> USE

package "KiteHub Platform (Modular Monolith)" {
    rectangle "Message Module" as MSG
    rectangle "Sale Module" as SALE

    rectangle "AI Agent Module" as AI
    rectangle "Maintaining Module" as MAINT

    rectangle "Storage" as STORAGE
    rectangle "AI Services" as AI_SVC

    MSG -[hidden]right- SALE
    AI -[hidden]right- MAINT
    AI -down-> AI_SVC
    MAINT -down-> STORAGE
}

note right of AI_SVC
    - GPT-4: Tạo marketing copy
    - SDXL: Tạo logo, banner
    - Remove.bg: Xóa nền ảnh
end note

package "KiteClass Instance #1\n(abc.kiteclass.com)" as KC1 {
    rectangle "Frontend" as FE1
    rectangle "User+Gateway" as UG1
    rectangle "Core Service" as CORE1
    rectangle "Engagement" as ENG1
    rectangle "Database" as DB1
    rectangle "Cache" as CACHE1
}

package "KiteClass Instance #2\n(xyz.kiteclass.com)" as KC2 {
    rectangle "Frontend" as FE2
    rectangle "User+Gateway" as UG2
    rectangle "Core Service" as CORE2
    rectangle "Database" as DB2
    rectangle "Cache" as CACHE2
}

package "KiteClass Instance #3\n(math123.kiteclass.com)" as KC3 {
    rectangle "Frontend" as FE3
    rectangle "User+Gateway" as UG3
    rectangle "Core Service" as CORE3
    rectangle "Database" as DB3
}

REG -down-> SALE
SALE -right-> AI : Tạo branding
AI -down-> MAINT : Quản lý
MAINT -down..> KC1 : Auto Provision\n(3-5 phút)
MAINT -down..> KC2 : Auto Provision
MAINT -down..> KC3 : Auto Provision

USE -down-> FE1
USE -down-> FE2
USE -down-> FE3

FE1 -down-> UG1
UG1 -down-> CORE1
UG1 -down-> ENG1
CORE1 -down-> DB1
CORE1 -right-> CACHE1

FE2 -down-> UG2
UG2 -down-> CORE2
CORE2 -down-> DB2
CORE2 -right-> CACHE2

FE3 -down-> UG3
UG3 -down-> CORE3
CORE3 -down-> DB3

legend bottom
|= Instance |= Ví dụ |= Quy mô |= Gói |= Services |= RAM |
| #1 abc.kiteclass.com | Trung tâm Anh ngữ ABC | 500 HV, 20 GV, 50 lớp | Premium $99/th | Core + Engagement | ~2.5GB |
| #2 xyz.kiteclass.com | Gia sư IELTS XYZ | 100 HV, 5 GV, 10 lớp | Standard $49/th | Core only | ~2GB |
| #3 math123.kiteclass.com | Lớp Toán thầy Minh | 30 HV, 1 GV, 3 lớp | Basic $29/th | Core minimal | ~1.5GB |
endlegend

@enduml
